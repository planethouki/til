# nem2-hon

## 目次

- トランザクションのデータ構造
    - Transfer Transaction
    - 略
    - Aggregate Bonded Transaction
    - Aggregate Complete Transaction
    - Cosignature Transaction
- トランザクションハッシュの計算
- 署名対象のデータ

- トランザクションを作成する

- トランザクションを送信する

- トランザクションの状態を確認する

## データ構造

### Transfer Transaction

以下の値を使ってトランザクションを作成した。

| 項目 | 値 |
|:-----:|:-----:|
| 宛先 | ランダム生成 |
| 送信モザイクID | `77A1969932D987D7` |
| 送信モザイク量 | `1000000` |
| メッセージ | 空文字 |
| 最大手数料 | `20000` |
| 送信者 | ランダム生成 |

作成した署名済みトランザクションのデータを示す。

A50000001D222BCC96CB8F2E677D12AA286CBB6C8CC796023F5D69A477BA013BD270F4A9252D7DF3085C238651FE152BF9025692654CCD7E47199A4ABB319117F767AA069A234CFEE354D683C6F225818D78C94CD2BC80A1380A02D9A354DD42BED6E60701905441204E000000000000F47791A61800000090866E1A131457ECF172889717CA9F846CD1F81A04A4AC067901000100D787D9329996A17740420F0000000000

### サイズ

```
A5000000
```

トランザクションのサイズを示す。

### 署名

```
1D222BCC96CB8F2E677D12AA286CBB6C8CC796023F5D69A477BA013BD270F4A9252D7DF3085C238651FE152BF9025692654CCD7E47199A4ABB319117F767AA06
```

トランザクションへの署名。

### 公開鍵

```
9A234CFEE354D683C6F225818D78C94CD2BC80A1380A02D9A354DD42BED6E607
```

署名したアカウントの公開鍵。また、モザイクの送信者でもある。

### バージョン

```
0190
```

トランザクションのバージョンを表す。`01`はElephantマイルストーンでは固定値。`90`はネットワークタイプが`MIJIN_TEST`であることを示す。

### トランザクションタイプ

```
5441
```

トランスファートランザクションであることを示す。

### 手数料

```
204E000000000000
```

最大手数料を示す。ビッグエンディアンに変換すると`4E20`であり、10進数に変換すると`20000`である。

### デッドライン

```
F47791A618000000
```

この時刻までに承認されなければならないことを示す。ビッグエンディアンに変換すると`18A69177F4`であり、10進数に変換すると`105873766388`である。この値は、ネメシスブロックからの経過ミリ秒を示す。ネメシスブロックのUnixtimeは`1459468800`であるので、デッドラインは`105873766388 + 1459468800 * 1000 = 1565342566388`となり、`2019/08/09 18:22:46`あたりを指し示す。

### 受取人

```
90866E1A131457ECF172889717CA9F846CD1F81A04A4AC0679
```

16進数のアドレスで表す。

### メッセージのサイズ

```
0100
```

ビッグエンディアンに変換すると`0001`であり、10進数に変換すると`1`である。メッセージタイプとメッセージ本文を合わせたサイズとなる。

### 送信モザイク数

```
01
```

モザイクは複数種類送れるため、その数をここに表す。

### メッセージタイプ

```
00
```

メッセージタイプを表す。

### モザイクID

```
D787D9329996A177
```

送信するモザイクのIDを表す。

### モザイク量

```
40420F0000000000
```

送信するモザイクの量を表す。


## Register Namespace Transaction

以下の値を使ってトランザクションを作成した。

| 項目 | 値 |
|:-----:|:-----:|
| 種別 | ルートネームスペース |
| ネームスペース名 | `foo` |
| 有効期限 | `1000` |
| 最大手数料 | `20000` |
| 送信者 | ランダム生成 |

作成した署名済みトランザクションのデータを示す。

8D000000DD7BB57C612C0DF1DC1C5D442E952FD42173991E7F082FBE5A02856AE8522440CBD3C13D0A60526FD013DA6C1271BB99718C1354505AD18EDE5FC56B51C4D20BA3F36F52E99CEAF735559AF3A5BB6F4B49F253A5CE964A49513FE3A3CC8211B501904E41204E000000000000197425AB1800000000E80300000000000054C07E58ACD1A98203666F6F

### サイズ

8D000000

### 署名

DD7BB57C612C0DF1DC1C5D442E952FD42173991E7F082FBE5A02856AE8522440CBD3C13D0A60526FD013DA6C1271BB99718C1354505AD18EDE5FC56B51C4D20B

### 公開鍵

A3F36F52E99CEAF735559AF3A5BB6F4B49F253A5CE964A49513FE3A3CC8211B5

### バージョン

0190

### トランザクションタイプ

4E41

### 手数料

204E000000000000

### デッドライン

197425AB18000000

### ネームスペースタイプ

```
00
```

ルートネームスペースかサブネームスペースかを表す。`00`であればルートネームスペース、`01`であればサブネームスペースを表す。

### 期間もしくは親ネームスペースID

```
E803000000000000
```

ルートネームスペースの場合、ネームスペースの有効期間を表す。単位はブロック数で記述し、トランザクションが承認されたブロックから、指定したブロック数が有効期間となる。

サブネームスペースの場合、親ネームスペースIDを表す。サブネームスペースの有効期間は親ネームスペースのものを引き継ぐ。

### ネームスペースID

```
54C07E58ACD1A982
```

ネームスペースIDを表す。ルートネームスペースの場合、ネームスペース名から一意に導出される。サブネームスペースの場合、親ネームスペースのIDとサブネームスペース名から導出される。

### ネームスペース名サイズ

```
03
```

この後に続くネームスペース名のサイズを表す。

### ネームスペース名

```
666F6F
```

ネームスペース名を表す。この例の場合は`foo`を示している。

## Mosaic Definition Transaction

以下の値を使ってトランザクションを作成した。

| 項目 | 値 |
|:-----:|:-----:|
| モザイクナンス | ランダム |
| 発行数変更 | 可能 |
| 送信 | 可能 |
| 分割数 | `0` |
| 期間 | `1000` |

作成した署名済みトランザクションのデータを示す。

9000000007D62C2FE05C8CEE90306D560E389CB274E37637CA58F3360E1750F0BFAAEEF0E3D7BB4D69B3C4B53D2BE461D1A6163594EF55DBFF678ABBCDF3D49D8EFA350E18EAB966209DD02200E7C14B5FE7622C64341BC08B17388E3016324986B5B81001904D41204E000000000000368F1CAC18000000C15B7110D92BB4432819F67101030002E803000000000000

### サイズ

90000000

### 署名

07D62C2FE05C8CEE90306D560E389CB274E37637CA58F3360E1750F0BFAAEEF0E3D7BB4D69B3C4B53D2BE461D1A6163594EF55DBFF678ABBCDF3D49D8EFA350E

### 公開鍵

18EAB966209DD02200E7C14B5FE7622C64341BC08B17388E3016324986B5B810

### バージョン

0190

### トランザクションタイプ

4D41

#### 手数料

204E000000000000

### デッドライン

368F1CAC18000000

### ナンス

```
C15B7110
```

モザイクIDを生成するためのナンスを表す。

### モザイクID

```
D92BB4432819F671
```

モザイクIDを表す。

### モザイクプロパティ数

```
01
```

モザイクに設定されるプロパティの数を表す。モザイクプロパティは`duration`しか存在しないため、基本的に`01`になる。

### モザイクフラグ

```
03
```

`supplyMutable`、`transferable`、`restrictable`の順にビット単位でフラグを表す。`0x03`の場合、`0b0011`なので、`supplyMutable`と`transferable`のフラグが立っている。

### 分割数

```
00
```

小数点以下の桁数を表す。最大値は`6`である。

### モザイクプロパティ

#### 期間（キー）

```
02
```

期間を表すモザイクプロパティのキーである。

#### 期間（値）

```
E803000000000000
```

モザイクの有効期間を表す。

## Mosaic Supply Change Transaction

以下の値を使ってトランザクションを作成した。

| 項目 | 値 |
|:-----:|:-----:|
| モザイクナンス | ランダム |
| 変更方向 | 増加 |
| 量 | `1000000` |

作成した署名済みトランザクションのデータを示す。

8900000021B1346EF0FADB1016CA725D30C1A67ECFF839FA02AE7A6AE0095433F35F6B27174FA277D7624432C756093CDFD573807587CB779F1D4E66F92F22E5E8AB52008673C06AE0069A3D856CA7AB96E30205A13485460EB0876B2A66BA8188C3405001904D42204E000000000000C1EE2AAD1800000029E42E1BB4EEAA590140420F0000000000

### サイズ

89000000

### 署名

21B1346EF0FADB1016CA725D30C1A67ECFF839FA02AE7A6AE0095433F35F6B27174FA277D7624432C756093CDFD573807587CB779F1D4E66F92F22E5E8AB5200

### 公開鍵

8673C06AE0069A3D856CA7AB96E30205A13485460EB0876B2A66BA8188C34050

### バージョン

0190

### トランザクションタイプ

4D42

### 手数料

204E000000000000


### デッドライン

C1EE2AAD18000000

### モザイクID 

```
29E42E1BB4EEAA59
```

操作対象のモザイクIDを表す。

### 変更方向

```
01
```

`01`なら増加、`00`なら減少を表す。

### 量

```
40420F0000000000
```

現在の発行量からの差分を表す。

## Secret Lock Transaction

以下の値を使ってトランザクションを作成した。

| 項目 | 値 |
|:-----:|:-----:|
| ロックモザイクID | `77A1969932D987D7` |
| ロックモザイク量 | `1000000` |
| ロック期間 | `960` |
| ハッシュ関数 | SHA3 256 |
| 秘密の値のハッシュ | ランダム生成 |
| 受け取り人 | ランダム生成 |

作成した署名済みトランザクションのデータを示す。

CA000000D680FEDFE00056B12B19DED7E104A809DB8025DBC130D9ED69B031FD997EF8B0FA18B884E9C872DFFE2DCBCF34AAEECDC3EFF4B7EE0257D2392123047EB71E02B5B2ADB6EE3FC77AB04DD0BF6676491E8D1B5B5EBAA832509BFE4CFDA5BDEBA201905241204E0000000000005C7877AC18000000D787D9329996A17740420F0000000000C00300000000000000DA85ABA910EAC1E0FEFD4BFCF73226CACAED694CA942DA6450FE19A64AD2C04A90E78A63AF27F41EBFC92B3E8EBBC0EE6BC7C21D4B05A11A73

## Secret Proof Transaction

以下の値を使ってトランザクションを作成した。

| 項目 | 値 |
|:-----:|:-----:|
| ハッシュ関数 | SHA3 256 |
| 秘密の値 | ランダム生成（10バイト） |
| 受け取り人 | ランダム生成 |

作成した署名済みトランザクションのデータを示す。

BE0000000F9B435E3D6E74E41C38452F1370013FF0CD98BB9EF327C72BE7EBCEB19D4E71D42D60CA2DCF4F3EEE039FF36427B4F8346D23BB33D99939446E9E313DFFEF06B9F21F2E55187AA24B1CF2746E7ECE1B0B62532E273AEAFEEAE2093228BF012101905242204E0000000000009CB077AC1800000000A2A4A2B87F53C3B4A65D93F03565AA3F12C92BB89C0E06741913FCC56BC17A6A908C59129D1D197E861990CAB26219B4D2EC96DCEAA857CBC80A00576739CDDF9DB9A6DE66

## Modify Multisig Transaction

アカウントをマルチシグ化するためのトランザクション。また、マルチシグアカウントの変更を行うのもこのトランザクションを用いる。変更には、署名アカウントの追加や削除、必要署名数の変更などがある。なお、マルチシグアカウントの変更を行う場合は、アグリゲートトランザクション化して特定数の連署が必要となるが、アカウントをマルチシグ化する場合においても、連署人の署名が必要となる。これには理由があり、ひとつのアカウントは複数のマルチシグアカウントの連署者になれるわけだが、この数は制限されており、ある一定の数になると連署者として新たに指定することができなくなる。これを悪用すると、特定のアカウントをマルチシグの連署者にすることができなくするような攻撃が想定される。これを防ぐために、アカウントをマルチシグ化する場合においても、連署人の署名が必要となる。

以下の値を使ってトランザクションを作成した。

| 項目 | 値 |
|:-----:|:-----:|
| マルチシグに変換するアカウント | ランダム生成 |
| 署名アカウント数 | `3` |
| 必要署名数 | `2` |
| 連署アカウント | ランダム生成 |

作成した署名済みトランザクションのデータを示す。

DE00000046BAC28BD682C6F88E313F1F1B3D7BF89A37FE6538DB60E9D927078A82A80332520085EC453E8876A3674911C435608CDF88B05C46F4B614CC563D32C1489C092027CC102997B7E77D2347E4732E240762D0A7A522CAD16104147BEEFC3B2EF601905541204E000000000000DC0F12B01800000002020300439EEE6EB9B40BACF37EA777D3BCDB59B5E2B0DA06252C8FA83079B0F1FE6BB900857B4512E1C7B82616922D72476F339D2B5212D1D11DE3AEF8C957F40C4A759F00FE9B2CB397EDB0E382AFFFC5AC7225ECDE6589A20480BE2A1B269705257D4B74

## Aggregate Transaction (Bonded)

以下の値を使ってトランザクションを作成した。

| 項目 | 値 |
|:-----:|:-----:|
| 内部トランザクション数 | `1` |
| 内部トランザクション | Transfer Transaction |

作成した署名済みトランザクションのデータを示す。

D10000003B4859817AC7FB98F198356EFE1DF9252C9AB7E9F301FF4C9E5929C8E60F805367088EE0763A0B8C3CD720941A64D9F924885717F1E2660EB145889E4AA49D075846367DD6046129F019A2AC973BC3B51102A871977D13133EA371D8169058A9019041420000000000000000005C16B1180000005500000055000000B12D63B8816BE7718CE18D5B6DEAE69D7037B290C415613CB800357F7380DA5A0190544190147DFE25234D7403E15844B55721580628B8AD7751B9928601000100D787D9329996A17740420F0000000000

## Aggregate Transaction (Complete)

以下の値を使ってトランザクションを作成した。

| 項目 | 値 |
|:-----:|:-----:|
| 内部トランザクション数 | `2` |
| 内部トランザクション | Transfer Transaction |

作成した署名済みトランザクションのデータを示す。

26010000F070D1019FBCBB2D2718563BB4AAF97F488F1EDFC25FE443A1EBE5C4221F8373FC2922FA397D55CB7F1941E8AF3F38EC2FC150268A35216C28F9A34479482306B12D63B8816BE7718CE18D5B6DEAE69D7037B290C415613CB800357F7380DA5A0190414100000000000000001B5C16B118000000AA00000055000000B12D63B8816BE7718CE18D5B6DEAE69D7037B290C415613CB800357F7380DA5A0190544190147DFE25234D7403E15844B55721580628B8AD7751B9928601000100D787D9329996A17740420F000000000055000000B12D63B8816BE7718CE18D5B6DEAE69D7037B290C415613CB800357F7380DA5A0190544190147DFE25234D7403E15844B55721580628B8AD7751B9928601000100D787D9329996A17780841E0000000000

## Cosignature Transaction

連署対象のトランザクションハッシュ

A628C2032547699EE8A6818D468AF0EB3E44C97554314087279860B057E18DDE

署名

721B02D3653C2C4D37AC97FDDF789412DF428E7B299A50D4B9BBF33FE8E9D889AFC162F7A267D2AB6827034A0B5A2724ED271554F12EAC4A63E3E3D45503E205

公開鍵

CB5EEC6C28AD2018CE5D56559DC1113B174ED16DCC1D70781E16EF190AFAECF0

## Hash Lock Transaction


以下の値を使ってトランザクションを作成した。

| 項目 | 値 |
|:-----:|:-----:|
| ロックするモザイクID | `77A1969932D987D7` |
| ロックするモザイク量 | `10000000` |
| 期間 | `480` |
| 対象のトランザクションハッシュ | `AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA` |

作成した署名済みトランザクションのデータを示す。

B0000000BC979BF1D6E2A8DDAE23CF9D32C1AF30951F8C255975A0D52887C7CA27224FC4C8C5CEB7323CCF871975A95E340F91D6A4C8773F5A9220117FFF6DA1E3F779071B980EAFDD0B0A920CCCFD8285E0C890F2C5974A41F60D19CB634173208B907701904841204E00000000000064F129B018000000D787D9329996A1778096980000000000E001000000000000AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA

## Address Alias Transaction

以下の値を使ってトランザクションを作成した。

| 項目 | 値 |
|:-----:|:-----:|
| ネームスペース名 | `foo` |
| 対象アドレス | ランダム生成 |
| リンクの種類 | 生成 |

作成した署名済みトランザクションのデータを示す。

9A0000004FD7588C3E6FE7485CADAFA2B4342F3851C82739687B6E32479A838F58758ACFEF432172E65188CA725C8CFBB7E5867045190FC0FDBAAF3637290810A3A64E0E83CFC0021AA39F308AA05E0535F6C3643DB944AB103C72AD5B118510D0B489C001904E42204E00000000000051E624B1180000000054C07E58ACD1A98290842FCE3F3C911AF9BEE3A7C00215F0ECEBFC78CAA2DCC16E

## Mosaic Alias Transaction

以下の値を使ってトランザクションを作成した。

| 項目 | 値 |
|:-----:|:-----:|
| モザイクID | ランダム生成 |
| 対象アドレス | ランダム生成 |
| リンクの種類 | 生成 |

作成した署名済みトランザクションのデータを示す。

8900000000A0EBC3C803584273FF70E59C8BFA93DB58A2709A27A9619E491D9E0987B892C8592D986F4F7FE4EA440DBF2E0C426EB87FA7206FC21262A485B959D385430983CFC0021AA39F308AA05E0535F6C3643DB944AB103C72AD5B118510D0B489C001904E43204E0000000000003DE624B1180000000054C07E58ACD1A98227F2DC9B0A0BC86A

## Account Address Restriction Transaction

以下の値を使ってトランザクションを作成した。

| 項目 | 値 |
|:-----:|:-----:|
| 制限タイプ | 許可 |
| 制限の種類 | 追加 |
| 制限するアドレス | ランダム生成 |

作成した署名済みトランザクションのデータを示す。

940000001C4780A6B712A63248D9DD991767BE40F402B4B631883D673F52426C885A0562AB4F51AF32EA10F92C72D910EE1394AC7BFD383C359FE23BD2D4A9CEC458150F7E008465491CC27A14B768AF20F19224590871B1244B2AC5E00815AF6AE91F7A01905041204E00000000000095344AB11800000001010090C55DE77EA74411C54065CD9A0CA0EF0E1C90A82CE5713355

## Account Mosaic Restriction Transaction

以下の値を使ってトランザクションを作成した。

| 項目 | 値 |
|:-----:|:-----:|
| 制限タイプ | 許可 |
| 制限の種類 | 追加 |
| 制限するモザイク | ランダム生成 |

作成した署名済みトランザクションのデータを示す。

830000006E4018258FE28ACDA9A71C46D088386CFEC868991422A69FC56D72B4FFF8E3E51B78EF0BC4B08B103418E5A63DC4A94F06EE3D2C2151577757E6C28309E6200B99F57E7A7551034CE50999BEA627606B30DF139260B0402F79020652ED7FBEB201905042204E0000000000009EE266B118000000020100C0BB527FA8BF2816

## Account Operation Restriction Transaction

以下の値を使ってトランザクションを作成した。

| 項目 | 値 |
|:-----:|:-----:|
| 制限タイプ | 許可 |
| 制限の種類 | 追加 |
| 制限するトランザクション | Transfer Transaction |

作成した署名済みトランザクションのデータを示す。

7D0000008C44A99215DAF2023B09778D1D61988083DB2150C9FB6CBEEBF60BE74859C79E17EE19741CAD4694028088E21B422BA4B6FD955B12E5ED1B3A47D2031625BA0AC6A2EC2730821E34C653DAA1AC848AF66EC5AC58957E1C859AA5741FCADF8ED901905043204E00000000000075BECAD5180000004401005441

### サイズ

7D000000

### 署名

8C44A99215DAF2023B09778D1D61988083DB2150C9FB6CBEEBF60BE74859C79E17EE19741CAD4694028088E21B422BA4B6FD955B12E5ED1B3A47D2031625BA0A

### 公開鍵 

C6A2EC2730821E34C653DAA1AC848AF66EC5AC58957E1C859AA5741FCADF8ED9

### バージョン

0190

### トランザクションタイプ

5043

### 手数料

204E000000000000

### デッドライン

75BECAD518000000

### 制限タイプ

```
44
```

### 設定の数

```
01
```

このトランザクションで変更される設定の数を表す。

### 設定

以下の２項目が、前項の値の分だけ連なる。

#### タイプ

```
00
```

`00`なら設定を追加する、`01`なら設定を削除することを表す。

#### トランザクションタイプ

```
5441
```

制限の対象となるトランザクションのタイプを表す。

## Account Link Transaction

委任ハーベスティングのために、他のアカウントへインポータンスを紐づける際に使用できる。紐づけするアカウントをリモートアカウントと呼ぶ。リモートアカウントはいくつかの制限事項があり、モザイクを保有していないこと、マルチシグアカウントではないこと、連署アカウントではないことがあげられる。また、複数のアカウントのリモートアカウントになることはできないし、自身のリモートアカウントにはなれない。

以下の値を使ってトランザクションを作成した。

| 項目 | 値 |
|:-----:|:-----:|
| リンク種別 | リンク |
| リンクする公開鍵 | ランダム生成 |

作成した署名済みトランザクションのデータを示す。

99000000B0DC2A7C7F7B937ACBD4BCDFCD5B99CC559CD6DC222332A26444D43264AC03C2791140E8819FFF5F144E719B52AFE9BC14D005BBC46447DE8B95130A9DC8E0084A8C1D7461A982B6DB0A8F74191237CD43275AA20486A31D35FFB8DD9917B5A301904C41204E000000000000E4EF7CB118000000095684D7EC6251B49685E80096F2F7EA6DADF798541479758CED6A6E28C94DAB00

### サイズ

99000000

### 署名

B0DC2A7C7F7B937ACBD4BCDFCD5B99CC559CD6DC222332A26444D43264AC03C2791140E8819FFF5F144E719B52AFE9BC14D005BBC46447DE8B95130A9DC8E008

### 公開鍵

4A8C1D7461A982B6DB0A8F74191237CD43275AA20486A31D35FFB8DD9917B5A3

### バージョン

0190

### トランザクションタイプ

4C41

### 手数料

204E000000000000

### デッドライン

E4EF7CB118000000

### リモートアカウント

```
095684D7EC6251B49685E80096F2F7EA6DADF798541479758CED6A6E28C94DAB
```

リモートアカウントの公開鍵を表す。

### リンクアクション

```
00
```

`00`ならリンク、`01`ならリンク解除を表す。